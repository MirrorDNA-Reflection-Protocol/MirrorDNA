{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mirrordna.org/schemas/memory.schema.json",
  "title": "MirrorDNA Memory Schema",
  "description": "Schema for memory records (short-term, long-term, episodic)",
  "version": "1.0.0",
  "type": "object",
  "required": ["memory_id", "tier", "content", "source"],
  "properties": {
    "memory_id": {
      "type": "string",
      "pattern": "^mem_[a-z0-9_]{12,}$",
      "description": "Unique memory identifier"
    },
    "tier": {
      "type": "string",
      "enum": ["short_term", "long_term", "episodic"],
      "description": "Memory tier classification"
    },
    "content": {
      "oneOf": [
        {"type": "string", "minLength": 1},
        {"type": "object"}
      ],
      "description": "Memory content (text or structured data)"
    },
    "source": {
      "type": "object",
      "required": ["session_id", "timestamp", "agent_id", "user_id"],
      "properties": {
        "session_id": {
          "type": "string",
          "pattern": "^sess_[a-z0-9_]{12,}$",
          "description": "Session where memory was created"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of memory creation"
        },
        "agent_id": {
          "type": "string",
          "pattern": "^mdna_agt_[a-z0-9_]{12,}$",
          "description": "Agent that created the memory"
        },
        "user_id": {
          "type": "string",
          "pattern": "^mdna_usr_[a-z0-9_]{12,}$",
          "description": "User associated with the memory"
        }
      },
      "additionalProperties": false
    },
    "metadata": {
      "type": "object",
      "description": "Additional memory metadata",
      "properties": {
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorization and search"
        },
        "relevance_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Relevance score (0-1)"
        },
        "access_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of times this memory was accessed"
        },
        "last_accessed": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of last access"
        },
        "embedding_vector": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "description": "Optional embedding vector for semantic search"
        },
        "custom": {
          "type": "object",
          "description": "Application-specific metadata"
        }
      }
    }
  },
  "additionalProperties": false
}
